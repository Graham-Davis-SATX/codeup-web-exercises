<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <title>Weather Map</title>
    <style>


        .jumbotron {
            padding-top: 20rem;
        }

        .bg-cover {
            background-image: url('img/weather.jpg');
            background-repeat: no-repeat;
            background-size: contain, cover;
            background-position: center;
            margin-top: 0;
            background-color: rgba(255, 255, 255, 0);

        }

        p > img {
            position: relative;
            top: -2px;
            padding: 0;
            margin: 0;
        }

        .description {
            margin-bottom: 0;
        }

        </style>

</head>
<body>
    <div class="container">
        <div class="jumbotron bg-cover mb-0"></div>
        <div class="row d-flex justify-content-center pt-3">
            <h3 class="text-primary text-center">Enter City Name</h3>
        </div>
        <div class="row d-flex justify-content-center">
            <div class="col-9">
                <div class="input-group pb-3">
                    <input type="text" name="city" id="city" class="form-control" placeholder="Enter City Name or Zip Code">
                    <div class="input-group-append">
                        <button id="submitWeather" class="btn btn-outline-primary" data-toggle="button" type="button">Search City</button>
                        <p id="error"></p>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4 col-12">
                <div class="card">
                    <div class="card-body text-center">
                        <h3 class="card-title" id="todayDate"></h3>
                        <p class="card-text"><div id="today" class="text-info"></div></p>
                    </div>
                </div>
            </div>
            <div class="col-md-4 col-12">
                <div class="card">
                    <div class="card-body text-center">
                        <h3 class="card-title" id="tomorrowDate"></h3>
                        <p class="card-text"><div id="tomorrow" class="text-danger"></div></p>
                    </div>
                </div>
            </div>
            <div class="col-md-4 col-12">
                <div class="card">
                    <div class="card-body text-center">
                        <h3 class="card-title" id="thirdDayDate"></h3>
                        <p class="card-text"><div id="day-three" class="text-success"></div></p>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>


<!-- Optional JavaScript -->
<script>
    $(document).ready(function() {
        "use strict";

        // this is the button that activates the ajax request
        $('#submitWeather').click(function(){

            // gets the value of the input field
            var city = $('#city').val();

            //check to see if input field is empty
            if(city != ''){

                $.ajax({ //city is passed in from the input field above
                   url: 'http://api.openweathermap.org/data/2.5/forecast?q=' + city + '&units=imperial' + '&APPID=7f8e3aa0aad113510e0c1eaafd1c17b8',
                    type: 'GET',
                    dataType: 'jsonp',
                    //request has been sent and the return info is stored in the 'data' callback
                    success: function(weatherData){
                        console.log(weatherData);
                        var widgetToday = showToday(weatherData);
                        var widgetTomorrow = showTomorrow(weatherData);
                        var widgetDayThree = showDayThree(weatherData);

                        $('#today').html(widgetToday);
                        $('#tomorrow').html(widgetTomorrow);
                        $('#day-three').html(widgetDayThree);

                        //empty the input field after button submission
                        $('#city').val('');
                    }
                });
                dayOfWeek();

            } else {
                $('#error').html('Field cannot be empty!');
            }

        });

        function dayOfWeek() {
            var d = new Date();
            var weekday = new Array(7);
            weekday[0] = "Sunday";
            weekday[1] = "Monday";
            weekday[2] = "Tuesday";
            weekday[3] = "Wednesday";
            weekday[4] = "Thursday";
            weekday[5] = "Friday";
            weekday[6] = "Saturday";

            var today = weekday[d.getDay()];
            $('#todayDate').html(today)
            var tomorrow = weekday[d.getDay() + 1];
            $('#tomorrowDate').html(tomorrow)
            var thirdDay = weekday[d.getDay() + 2];
            $('#thirdDayDate').html(thirdDay)
        }

        function degToCompass(num) {
            var val = Math.floor((num / 22.5) + 0.5);
            var arr = ["N", "NNE", "NE", "ENE", "E", "ESE", "SE", "SSE", "S", "SSW", "SW", "WSW", "W", "WNW", "NW", "NNW"];
            return arr[(val % 16)];
        }

        function hpaInches(num) {
            var val = (num * .030);
            return val.toFixed(2)
        }

        function showToday(weatherData){
            return  '<div class="container"><div class="row">' +
                '<div class="col"><h6 class="description"><strong>' + '<img src="http://openweathermap.org/img/w/' + weatherData.list[0].weather[0].icon +'.png">' + weatherData.list[0].weather[0].description + '</strong>' + '<img src="http://openweathermap.org/img/w/' + weatherData.list[0].weather[0].icon +'.png">' + '</h6></div></div>' +
                '<div class="row"><div class="col-6"><p><strong>High</strong>:<br> '+ weatherData.list[0].main.temp_max +' &degF</p></div>' +
                '<div class="col-6"><p><strong>Low</strong>:<br> '+ weatherData.list[0].main.temp_min +' &degF</p></div>' +
                '<div class="col-6"><p><strong>Wind Speed</strong>:<br> '+ weatherData.list[0].wind.speed +' mph' + '</p></div>' +
                '<div class="col-6"><p><strong>Wind Direction</strong>:<br> '+ degToCompass(weatherData.list[0].wind.deg) + '</p></div>' +
                '<div class="col"><p><strong>Humidity</strong>:<br> '+ weatherData.list[0].main.humidity +' %</p></div>' +
                '<div class="col"><p><strong>Barrometer</strong>:<br> '+ hpaInches(weatherData.list[0].main.pressure) +' inches</p></div>';
        }

        function showTomorrow(weatherData){
            return  '<div class="container"><div class="row">' +
                '<div class="col"><h6 class="description"><strong>' + '<img src="http://openweathermap.org/img/w/' + weatherData.list[8].weather[0].icon +'.png">' + weatherData.list[8].weather[0].description + '</strong>' + '<img src="http://openweathermap.org/img/w/' + weatherData.list[8].weather[0].icon +'.png">' + '</h6></div></div>' +
                '<div class="row"><div class="col-6"><p><strong>High</strong>:<br> '+ weatherData.list[8].main.temp_max +' &degF</p></div>' +
                '<div class="col-6"><p><strong>Low</strong>:<br> '+ weatherData.list[8].main.temp_min +' &degF</p></div>' +
                '<div class="col-6"><p><strong>Wind Speed</strong>:<br> '+ weatherData.list[8].wind.speed +' mph' + '</p></div>' +
                '<div class="col-6"><p><strong>Wind Direction</strong>:<br> '+ degToCompass(weatherData.list[8].wind.deg) + '</p></div>' +
                '<div class="col"><p><strong>Humidity</strong>:<br> '+ weatherData.list[8].main.humidity +' %</p></div>' +
                '<div class="col"><p><strong>Barrometer</strong>:<br> '+ hpaInches(weatherData.list[8].main.pressure) +' inches</p></div>';
        }

        function showDayThree(weatherData){
            return  '<div class="container"><div class="row">' +
                '<div class="col"><h6 class="description"><strong>' + '<img src="http://openweathermap.org/img/w/' + weatherData.list[16].weather[0].icon +'.png">' + weatherData.list[16].weather[0].description + '</strong>' + '<img src="http://openweathermap.org/img/w/' + weatherData.list[16].weather[0].icon +'.png">' + '</h6></div></div>' +
                '<div class="row"><div class="col-6"><p><strong>High</strong>:<br> '+ weatherData.list[16].main.temp_max +' &degF</p></div>' +
                '<div class="col-6"><p><strong>Low</strong>:<br> '+ weatherData.list[16].main.temp_min +' &degF</p></div>' +
                '<div class="col-6"><p><strong>Wind Speed</strong>:<br> '+ weatherData.list[16].wind.speed +' mph' + '</p></div>' +
                '<div class="col-6"><p><strong>Wind Direction</strong>:<br> '+ degToCompass(weatherData.list[16].wind.deg) + '</p></div>' +
                '<div class="col"><p><strong>Humidity</strong>:<br> '+ weatherData.list[16].main.humidity +' %</p></div>' +
                '<div class="col"><p><strong>Barrometer</strong>:<br> '+ hpaInches(weatherData.list[16].main.pressure) +' inches</p></div>';
        }


    }); //ends the doc.ready func

</script>
</body>
</html>